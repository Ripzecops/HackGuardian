<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è Pentester Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #151932;
            --bg-tertiary: #1e2447;
            --accent-cyan: #00f0ff;
            --accent-purple: #a855f7;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #2d3560;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #0f1629 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Background Animation */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }

        .circuit-line {
            position: absolute;
            background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent);
            animation: circuit-flow 8s linear infinite;
        }

        @keyframes circuit-flow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200vw); }
        }

        /* Main Container */
        .container {
            position: relative;
            z-index: 1;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(21, 25, 50, 0.8);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--border-color);
            padding: 2rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .logo {
            padding: 0 2rem 2rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            padding: 0.75rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-secondary);
        }

        .nav-item:hover {
            background: rgba(0, 240, 255, 0.05);
            border-left-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .nav-item.active {
            background: rgba(0, 240, 255, 0.1);
            border-left-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .nav-icon {
            font-size: 1.2rem;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100vw - 280px);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header h2 {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            color: white;
            box-shadow: 0 4px 15px rgba(0, 240, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 240, 255, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(21, 25, 50, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 240, 255, 0.2);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-title {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-icon {
            font-size: 2rem;
            opacity: 0.5;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-subtitle {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Card */
        .card {
            background: rgba(21, 25, 50, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Table */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        tr:hover {
            background: rgba(0, 240, 255, 0.05);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
            border: 1px solid var(--accent-red);
        }

        .badge-high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-orange);
            border: 1px solid var(--accent-orange);
        }

        .badge-medium {
            background: rgba(168, 85, 247, 0.2);
            color: var(--accent-purple);
            border: 1px solid var(--accent-purple);
        }

        .badge-low {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }

        .badge-open {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .badge-progress {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-orange);
        }

        .badge-fixed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-green);
        }

        /* Chart Placeholder */
        .chart {
            height: 300px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            gap: 1rem;
            padding: 1rem;
            border-radius: 8px;
            background: rgba(10, 14, 39, 0.5);
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, var(--accent-cyan), var(--accent-purple));
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .chart-bar:hover {
            opacity: 0.8;
            transform: scaleY(1.05);
        }

        .chart-label {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Activity List */
        .activity-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.3s ease;
        }

        .activity-item:hover {
            background: rgba(0, 240, 255, 0.05);
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 240, 255, 0.1);
            color: var(--accent-cyan);
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .activity-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 240, 255, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-red);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 1rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab:hover {
            color: var(--accent-cyan);
        }

        .tab.active {
            color: var(--accent-cyan);
            border-bottom-color: var(--accent-cyan);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--accent-green);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 2000;
            animation: slideInRight 0.3s ease;
            display: none;
        }

        .notification.show {
            display: block;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-cyan);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-purple);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                max-width: 100vw;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Action Icons */
        .action-icons {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: rgba(0, 240, 255, 0.1);
            color: var(--accent-cyan);
        }

        /* Target List */
        .target-list {
            display: grid;
            gap: 1rem;
        }

        .target-item {
            background: rgba(30, 36, 71, 0.5);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .target-item:hover {
            border-color: var(--accent-cyan);
            transform: translateX(5px);
        }

        .target-info h4 {
            margin-bottom: 0.5rem;
        }

        .target-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Settings Grid */
        .settings-grid {
            display: grid;
            gap: 1.5rem;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(30, 36, 71, 0.5);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: var(--bg-tertiary);
            border-radius: 13px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: var(--accent-cyan);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(24px);
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation" id="bgAnimation"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <h1>üõ°Ô∏è PenTest Pro</h1>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item active" data-view="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span>Dashboard</span>
                    </li>
                    <li class="nav-item" data-view="targets">
                        <span class="nav-icon">üéØ</span>
                        <span>Targets</span>
                    </li>
                    <li class="nav-item" data-view="vulnerabilities">
                        <span class="nav-icon">üîì</span>
                        <span>Vulnerabilities</span>
                    </li>
                    <li class="nav-item" data-view="evidence">
                        <span class="nav-icon">üì∏</span>
                        <span>Evidence</span>
                    </li>
                    <li class="nav-item" data-view="scans">
                        <span class="nav-icon">üîç</span>
                        <span>Scans</span>
                    </li>
                    <li class="nav-item" data-view="reports">
                        <span class="nav-icon">üìÑ</span>
                        <span>Reports</span>
                    </li>
                    <li class="nav-item" data-view="users">
                        <span class="nav-icon">üë•</span>
                        <span>Users & Roles</span>
                    </li>
                    <li class="nav-item" data-view="collaboration">
                        <span class="nav-icon">üí¨</span>
                        <span>Collaboration</span>
                    </li>
                    <li class="nav-item" data-view="compliance">
                        <span class="nav-icon">‚úÖ</span>
                        <span>Compliance</span>
                    </li>
                    <li class="nav-item" data-view="logs">
                        <span class="nav-icon">üìã</span>
                        <span>Activity Logs</span>
                    </li>
                    <li class="nav-item" data-view="settings">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>Settings</span>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="view-dashboard" class="view active">
                <div class="header">
                    <h2>üõ°Ô∏è Security Dashboard</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="refreshDashboard()">
                            üîÑ Refresh
                        </button>
                        <button class="btn btn-primary" onclick="openModal('newVulnerability')">
                            ‚ûï New Finding
                        </button>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Total Vulnerabilities</span>
                            <span class="stat-icon">üîì</span>
                        </div>
                        <div class="stat-value" id="stat-total-vulns" style="color: var(--accent-cyan);">247</div>
                        <div class="stat-subtitle">Total active findings</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Critical Issues</span>
                            <span class="stat-icon">‚ö†Ô∏è</span>
                        </div>
                        <div class="stat-value" id="stat-critical-vulns" style="color: var(--accent-red);">18</div>
                        <div class="stat-subtitle">Require immediate attention</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Fixed This Week</span>
                            <span class="stat-icon">‚úÖ</span>
                        </div>
                        <div class="stat-value" id="stat-fixed-vulns" style="color: var(--accent-green);">34</div>
                        <div class="stat-subtitle">62% resolution rate</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Last Scan</span>
                            <span class="stat-icon">üïê</span>
                        </div>
                        <div class="stat-value" style="font-size: 1.5rem; color: var(--accent-purple);">2h ago</div>
                        <div class="stat-subtitle">Next scan in 6 hours</div>
                    </div>
                </div>

                <!-- Content Grid -->
                <div class="content-grid">
                    <!-- Recent Vulnerabilities -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Vulnerabilities</h3>
                            <button class="btn btn-secondary" onclick="switchView('vulnerabilities')">View All</button>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Severity</th>
                                        <th>Target</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-vuln-list">
                                    <!-- Dynamic Content -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Activity</h3>
                        </div>
                        <div class="activity-list" id="dashboard-activity-list">
                           <!-- Dynamic Content -->
                        </div>
                    </div>
                </div>

                <!-- Severity Chart -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <h3 class="card-title">Vulnerability Severity Distribution</h3>
                    </div>
                    <div class="chart">
                        <div style="flex: 1;">
                            <div class="chart-bar" id="chart-critical" style="height: 15%; background: linear-gradient(to top, #ef4444, #dc2626);"></div>
                            <div class="chart-label">Critical<br><span id="chart-val-critical">0</span></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="chart-bar" id="chart-high" style="height: 25%; background: linear-gradient(to top, #f59e0b, #d97706);"></div>
                            <div class="chart-label">High<br><span id="chart-val-high">0</span></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="chart-bar" id="chart-medium" style="height: 45%; background: linear-gradient(to top, #a855f7, #9333ea);"></div>
                            <div class="chart-label">Medium<br><span id="chart-val-medium">0</span></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="chart-bar" id="chart-low" style="height: 30%; background: linear-gradient(to top, #10b981, #059669);"></div>
                            <div class="chart-label">Low<br><span id="chart-val-low">0</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Targets View -->
            <div id="view-targets" class="view" style="display: none;">
                <div class="header">
                    <h2>üéØ Target Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openModal('newTarget')">
                            ‚ûï Add Target
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="target-list" id="target-list-container">
                        <!-- Dynamic Targets -->
                    </div>
                </div>
            </div>

            <!-- Vulnerabilities View -->
            <div id="view-vulnerabilities" class="view" style="display: none;">
                <div class="header">
                    <h2>üîì Vulnerability Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary">Filter</button>
                        <button class="btn btn-primary" onclick="openModal('newVulnerability')">
                            ‚ûï New Finding
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Title</th>
                                    <th>Severity</th>
                                    <th>Target</th>
                                    <th>Status</th>
                                    <th>CWE</th>
                                    <th>Assigned</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="vuln-table-body">
                                <!-- Dynamic Content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Evidence View -->
            <div id="view-evidence" class="view" style="display: none;">
                <div class="header">
                    <h2>üì∏ Evidence & Proof Collection</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openModal('uploadEvidence')">
                            ‚¨ÜÔ∏è Upload Evidence
                        </button>
                    </div>
                </div>

                <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Screenshots</span>
                            <span class="stat-icon">üñºÔ∏è</span>
                        </div>
                        <div class="stat-value" id="stat-ev-screenshots">156</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Request Logs</span>
                            <span class="stat-icon">üìù</span>
                        </div>
                        <div class="stat-value" id="stat-ev-logs">89</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Text Notes</span>
                            <span class="stat-icon">üìÑ</span>
                        </div>
                        <div class="stat-value" id="stat-ev-notes">42</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recent Evidence</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Linked To</th>
                                    <th>Uploaded</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="evidence-table-body">
                                <!-- Dynamic Content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Scans View -->
            <div id="view-scans" class="view" style="display: none;">
                <div class="header">
                    <h2>üîç Scan Results Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary">Compare Scans</button>
                        <button class="btn btn-primary" onclick="runNewScan()">
                            ‚ñ∂Ô∏è Run New Scan
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Scan History</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Scan ID</th>
                                    <th>Target</th>
                                    <th>Date</th>
                                    <th>Findings</th>
                                    <th>Critical</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="scan-table-body">
                                <!-- Dynamic Content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports View -->
            <div id="view-reports" class="view" style="display: none;">
                <div class="header">
                    <h2>üìÑ Reporting System</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openModal('generateReport')">
                            ‚ú® Generate Report
                        </button>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="switchTab('executive', event)">Executive Summary</div>
                    <div class="tab" onclick="switchTab('technical', event)">Technical Findings</div>
                    <div class="tab" onclick="switchTab('history', event)">Report History</div>
                </div>

                <div id="tab-executive" class="tab-content active">
                    <div class="card">
                        <h3 style="margin-bottom: 1rem;">Report Templates</h3>
                        <div class="target-list">
                            <div class="target-item">
                                <div class="target-info">
                                    <h4>Executive Summary Report</h4>
                                    <div class="target-meta">High-level overview for management</div>
                                </div>
                                <button class="btn btn-primary" onclick="openModal('generateReport')">Generate</button>
                            </div>
                            <div class="target-item">
                                <div class="target-info">
                                    <h4>Technical Detailed Report</h4>
                                    <div class="target-meta">Comprehensive technical analysis</div>
                                </div>
                                <button class="btn btn-primary" onclick="openModal('generateReport')">Generate</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-technical" class="tab-content">
                    <div class="card">
                        <p>Technical report configuration coming soon...</p>
                    </div>
                </div>

                <div id="tab-history" class="tab-content">
                    <div class="card">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Report Name</th>
                                        <th>Type</th>
                                        <th>Generated</th>
                                        <th>Format</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Q4 2024 Security Report</td>
                                        <td>Executive</td>
                                        <td>2024-12-28</td>
                                        <td>PDF</td>
                                        <td>
                                            <div class="action-icons">
                                                <button class="action-btn" title="Download">‚¨áÔ∏è</button>
                                                <button class="action-btn" title="Share">üì§</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users View -->
            <div id="view-users" class="view" style="display: none;">
                <div class="header">
                    <h2>üë• User & Role Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openModal('addUser')">
                            ‚ûï Add User
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Last Active</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="user-table-body">
                                <!-- Dynamic Content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Collaboration View -->
            <div id="view-collaboration" class="view" style="display: none;">
                <div class="header">
                    <h2>üí¨ Collaboration & Workflow</h2>
                </div>
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Assigned Tasks</h3>
                        </div>
                        <div class="target-list">
                             <div class="target-item">
                                <div class="target-info">
                                    <h4>Verify SQL Injection Fix</h4>
                                    <div class="target-meta">
                                        <span class="badge badge-critical">High Priority</span> ‚Ä¢ 
                                        Assigned to: John Doe
                                    </div>
                                </div>
                                <button class="btn btn-secondary">View</button>
                            </div>
                        </div>
                    </div>
                     <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Comments</h3>
                        </div>
                        <div class="activity-list">
                            <div class="activity-item">
                                <div class="activity-icon">üí¨</div>
                                <div class="activity-content">
                                    <div class="activity-title">John: "Fix verified and working"</div>
                                    <div class="activity-meta">On #001 - SQL Injection ‚Ä¢ 1 hour ago</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Compliance View -->
            <div id="view-compliance" class="view" style="display: none;">
                <div class="header">
                    <h2>‚úÖ Compliance & Standards Mapping</h2>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">OWASP Top 10</span>
                            <span class="stat-icon">üõ°Ô∏è</span>
                        </div>
                        <div class="stat-value">8/10</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">Compliance Score</span>
                            <span class="stat-icon">üìä</span>
                        </div>
                        <div class="stat-value">78%</div>
                    </div>
                </div>
                 <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">OWASP Top 10 Mapping</h3>
                    </div>
                     <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>OWASP Category</th><th>Findings</th><th>Status</th></tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>A01:2021 - Broken Access Control</td>
                                    <td>12</td>
                                    <td><div class="progress-bar"><div class="progress-fill" style="width: 40%;"></div></div></td>
                                </tr>
                                <tr>
                                    <td>A03:2021 - Injection</td>
                                    <td>8</td>
                                    <td><div class="progress-bar"><div class="progress-fill" style="width: 25%;"></div></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Activity Logs View -->
            <div id="view-logs" class="view" style="display: none;">
                <div class="header">
                    <h2>üìã Activity Logs & Audit Trail</h2>
                </div>
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Resource</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="log-table-body">
                                <!-- Dynamic logs -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="view-settings" class="view" style="display: none;">
                <div class="header">
                    <h2>‚öôÔ∏è Settings & Customization</h2>
                </div>
                <div class="card">
                    <h3 style="margin-bottom: 1.5rem;">General Settings</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <div>
                                <h4>Dark Mode</h4>
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Toggle dark/light theme</p>
                            </div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal: New Vulnerability -->
    <div id="modal-newVulnerability" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ûï New Vulnerability</h3>
                <button class="modal-close" onclick="closeModal('newVulnerability')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Title</label>
                    <input type="text" id="input-vuln-title" class="form-input" placeholder="e.g., SQL Injection in Login Form">
                </div>
                <div class="form-group">
                    <label class="form-label">Severity</label>
                    <select id="input-vuln-severity" class="form-select">
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Target</label>
                    <select id="input-vuln-target" class="form-select">
                        <option>example.com</option>
                        <option>api.example.com</option>
                        <option>admin.example.com</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">CWE Reference</label>
                    <input type="text" id="input-vuln-cwe" class="form-input" placeholder="e.g., CWE-89">
                </div>
                <div class="form-group">
                    <label class="form-label">Assigned To</label>
                    <input type="text" id="input-vuln-assigned" class="form-input" value="John Doe">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('newVulnerability')">Cancel</button>
                <button class="btn btn-primary" onclick="createVulnerability()">Create Finding</button>
            </div>
        </div>
    </div>

    <!-- Modal: New Target -->
    <div id="modal-newTarget" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üéØ Add New Target</h3>
                <button class="modal-close" onclick="closeModal('newTarget')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Target URL/Name</label>
                    <input type="text" id="input-target-name" class="form-input" placeholder="e.g., example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Type</label>
                    <select id="input-target-type" class="form-select">
                        <option>Website</option>
                        <option>API</option>
                        <option>Mobile App</option>
                        <option>Web Application</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select id="input-target-status" class="form-select">
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('newTarget')">Cancel</button>
                <button class="btn btn-primary" onclick="createTarget()">Add Target</button>
            </div>
        </div>
    </div>

    <!-- Modal: Upload Evidence -->
    <div id="modal-uploadEvidence" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üì∏ Upload Evidence</h3>
                <button class="modal-close" onclick="closeModal('uploadEvidence')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Evidence Type</label>
                    <select id="input-ev-type" class="form-select">
                        <option>Screenshot</option>
                        <option>Request/Response Log</option>
                        <option>Text Note</option>
                        <option>Video</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" id="input-ev-desc" class="form-input" placeholder="e.g., Payload details">
                </div>
                <div class="form-group">
                    <label class="form-label">Link to Vulnerability</label>
                    <select id="input-ev-link" class="form-select">
                        <option>#001 - SQL Injection</option>
                        <option>#002 - XSS Attack</option>
                        <option>General</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">File</label>
                    <input type="file" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('uploadEvidence')">Cancel</button>
                <button class="btn btn-primary" onclick="uploadEvidence()">Upload</button>
            </div>
        </div>
    </div>

    <!-- Modal: Generate Report -->
    <div id="modal-generateReport" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ú® Generate Report</h3>
                <button class="modal-close" onclick="closeModal('generateReport')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Report Type</label>
                    <select class="form-select">
                        <option>Executive Summary</option>
                        <option>Technical Findings</option>
                        <option>Compliance Report</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Format</label>
                    <select class="form-select">
                        <option>PDF</option>
                        <option>HTML</option>
                        <option>DOCX</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('generateReport')">Cancel</button>
                <button class="btn btn-primary" onclick="generateReport()">Generate</button>
            </div>
        </div>
    </div>

    <!-- Modal: Add User -->
    <div id="modal-addUser" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üë§ Add New User</h3>
                <button class="modal-close" onclick="closeModal('addUser')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" id="input-user-name" class="form-input" placeholder="e.g., John Doe">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" id="input-user-email" class="form-input" placeholder="john@example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Role</label>
                    <select id="input-user-role" class="form-select">
                        <option value="Pentester">Pentester</option>
                        <option value="Admin">Admin</option>
                        <option value="Reviewer">Reviewer</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addUser')">Cancel</button>
                <button class="btn btn-primary" onclick="addUser()">Add User</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <script>
        // --- 1. DATA STATE & INITIALIZATION ---
        
        // Initial Mock Data
        const appData = {
            vulnerabilities: [
                { id: '001', title: 'SQL Injection in Login', severity: 'Critical', target: 'example.com', status: 'Open', cwe: 'CWE-89', assigned: 'John Doe' },
                { id: '002', title: 'XSS in Search Param', severity: 'High', target: 'api.example.com', status: 'In Progress', cwe: 'CWE-79', assigned: 'Jane Smith' },
                { id: '003', title: 'Missing Security Headers', severity: 'Medium', target: 'admin.example.com', status: 'Fixed', cwe: 'CWE-693', assigned: 'John Doe' },
                { id: '004', title: 'Weak Password Policy', severity: 'Low', target: 'example.com', status: 'Open', cwe: 'CWE-521', assigned: 'Jane Smith' }
            ],
            targets: [
                { id: 't1', name: 'example.com', type: 'Website', status: 'Active', api: 'Yes', lastScan: '2 hours ago' },
                { id: 't2', name: 'api.example.com', type: 'API', status: 'Active', api: 'Yes', lastScan: '1 day ago' },
                { id: 't3', name: 'admin.example.com', type: 'Web App', status: 'Inactive', api: 'No', lastScan: '1 week ago' }
            ],
            evidence: [
                { id: 'e1', type: 'Screenshot', desc: 'SQL Injection Payload Response', link: '#001 - SQL Injection', uploaded: '2 hours ago', badge: 'medium' },
                { id: 'e2', type: 'Request Log', desc: 'XSS Exploitation Request', link: '#002 - XSS Attack', uploaded: '4 hours ago', badge: 'low' }
            ],
            scans: [
                { id: '#SC-001', target: 'example.com', date: '2025-01-01 10:30', findings: 47, critical: 3, status: 'Completed' },
                { id: '#SC-002', target: 'api.example.com', date: '2024-12-30 14:15', findings: 62, critical: 5, status: 'Completed' }
            ],
            users: [
                { id: 'u1', name: 'John Doe', email: 'john@example.com', role: 'Admin', status: 'Active', lastActive: '2 hours ago', badge: 'critical' },
                { id: 'u2', name: 'Jane Smith', email: 'jane@example.com', role: 'Pentester', status: 'Active', lastActive: '1 day ago', badge: 'high' }
            ],
            logs: [
                { time: '2025-01-01 12:30:45', user: 'John Doe', action: 'Created', resource: 'Vuln #001', details: 'SQL Injection finding added', badge: 'low' },
                { time: '2025-01-01 11:15:22', user: 'Jane Smith', action: 'Updated', resource: 'Vuln #002', details: 'Status changed to In Progress', badge: 'medium' }
            ]
        };

        // --- 2. RENDER FUNCTIONS ---

        function renderAll() {
            renderDashboard();
            renderTargets();
            renderVulnerabilities();
            renderEvidence();
            renderScans();
            renderUsers();
            renderLogs();
        }

        function getSeverityBadge(severity) {
            const map = { 'Critical': 'badge-critical', 'High': 'badge-high', 'Medium': 'badge-medium', 'Low': 'badge-low' };
            return map[severity] || 'badge-low';
        }

        function getStatusBadge(status) {
            const map = { 'Open': 'badge-open', 'In Progress': 'badge-progress', 'Fixed': 'badge-fixed', 'Active': 'badge-high', 'Inactive': 'badge-low', 'Completed': 'badge-fixed' };
            return map[status] || 'badge-low';
        }

        function renderDashboard() {
            // Stats
            const criticalCount = appData.vulnerabilities.filter(v => v.severity === 'Critical').length;
            const highCount = appData.vulnerabilities.filter(v => v.severity === 'High').length;
            const mediumCount = appData.vulnerabilities.filter(v => v.severity === 'Medium').length;
            const lowCount = appData.vulnerabilities.filter(v => v.severity === 'Low').length;
            const fixedCount = appData.vulnerabilities.filter(v => v.status === 'Fixed').length;
            const totalCount = appData.vulnerabilities.length;

            document.getElementById('stat-total-vulns').textContent = totalCount;
            document.getElementById('stat-critical-vulns').textContent = criticalCount;
            document.getElementById('stat-fixed-vulns').textContent = fixedCount + 34; // adding dummy historical data

            // Chart
            const maxVal = Math.max(criticalCount, highCount, mediumCount, lowCount, 1);
            
            document.getElementById('chart-critical').style.height = `${(criticalCount/maxVal)*80 + 10}%`;
            document.getElementById('chart-val-critical').textContent = criticalCount;
            
            document.getElementById('chart-high').style.height = `${(highCount/maxVal)*80 + 10}%`;
            document.getElementById('chart-val-high').textContent = highCount;
            
            document.getElementById('chart-medium').style.height = `${(mediumCount/maxVal)*80 + 10}%`;
            document.getElementById('chart-val-medium').textContent = mediumCount;
            
            document.getElementById('chart-low').style.height = `${(lowCount/maxVal)*80 + 10}%`;
            document.getElementById('chart-val-low').textContent = lowCount;

            // Recent Vulns Table
            const dbVulnList = document.getElementById('dashboard-vuln-list');
            dbVulnList.innerHTML = '';
            appData.vulnerabilities.slice(0, 4).forEach(v => {
                const row = `
                    <tr>
                        <td>${v.title}</td>
                        <td><span class="badge ${getSeverityBadge(v.severity)}">${v.severity}</span></td>
                        <td>${v.target}</td>
                        <td><span class="badge ${getStatusBadge(v.status)}">${v.status}</span></td>
                        <td>
                             <div class="action-icons">
                                <button class="action-btn" onclick="showNotification('Opening edit view...')">‚úèÔ∏è</button>
                                <button class="action-btn" onclick="switchView('vulnerabilities')">üëÅÔ∏è</button>
                            </div>
                        </td>
                    </tr>`;
                dbVulnList.innerHTML += row;
            });

            // Recent Activity
            const activityList = document.getElementById('dashboard-activity-list');
            activityList.innerHTML = '';
            appData.logs.slice(0, 5).forEach(log => {
                const icon = log.action === 'Created' ? 'üîì' : (log.action === 'Updated' ? 'üìù' : '‚úÖ');
                const item = `
                    <div class="activity-item">
                        <div class="activity-icon">${icon}</div>
                        <div class="activity-content">
                            <div class="activity-title">${log.details}</div>
                            <div class="activity-meta">${log.user} ‚Ä¢ ${log.time}</div>
                        </div>
                    </div>`;
                activityList.innerHTML += item;
            });
        }

        function renderTargets() {
            const container = document.getElementById('target-list-container');
            container.innerHTML = '';
            appData.targets.forEach((t, index) => {
                const badgeClass = t.status === 'Active' ? 'badge-high' : 'badge-low';
                const html = `
                    <div class="target-item">
                        <div class="target-info">
                            <h4>${t.name}</h4>
                            <div class="target-meta">
                                <span class="badge ${badgeClass}">${t.status}</span> ‚Ä¢ 
                                <span>Type: ${t.type}</span> ‚Ä¢ 
                                <span>Last scan: ${t.lastScan}</span>
                            </div>
                        </div>
                        <div class="action-icons">
                            <button class="action-btn" title="Edit">‚úèÔ∏è</button>
                            <button class="action-btn" title="Scan" onclick="runNewScan()">üîç</button>
                            <button class="action-btn" title="Delete" onclick="deleteItem('targets', ${index})">üö´</button>
                        </div>
                    </div>`;
                container.innerHTML += html;
            });
        }

        function renderVulnerabilities() {
            const tbody = document.getElementById('vuln-table-body');
            tbody.innerHTML = '';
            appData.vulnerabilities.forEach((v, index) => {
                const html = `
                    <tr>
                        <td>#${v.id}</td>
                        <td>${v.title}</td>
                        <td><span class="badge ${getSeverityBadge(v.severity)}">${v.severity}</span></td>
                        <td>${v.target}</td>
                        <td><span class="badge ${getStatusBadge(v.status)}">${v.status}</span></td>
                        <td>${v.cwe}</td>
                        <td>${v.assigned}</td>
                        <td>
                            <div class="action-icons">
                                <button class="action-btn" title="Edit">‚úèÔ∏è</button>
                                <button class="action-btn" title="Delete" onclick="deleteItem('vulnerabilities', ${index})">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>`;
                tbody.innerHTML += html;
            });
        }

        function renderEvidence() {
            // Stats
            document.getElementById('stat-ev-screenshots').textContent = appData.evidence.filter(e => e.type === 'Screenshot').length + 150;
            document.getElementById('stat-ev-logs').textContent = appData.evidence.filter(e => e.type === 'Request Log').length + 80;
            document.getElementById('stat-ev-notes').textContent = appData.evidence.filter(e => e.type === 'Text Note').length + 40;

            const tbody = document.getElementById('evidence-table-body');
            tbody.innerHTML = '';
            appData.evidence.forEach((e, index) => {
                const html = `
                    <tr>
                        <td><span class="badge ${e.badge === 'medium' ? 'badge-medium' : 'badge-low'}">${e.type}</span></td>
                        <td>${e.desc}</td>
                        <td>${e.link}</td>
                        <td>${e.uploaded}</td>
                        <td>
                            <div class="action-icons">
                                <button class="action-btn">üëÅÔ∏è</button>
                                <button class="action-btn" onclick="deleteItem('evidence', ${index})">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>`;
                tbody.innerHTML += html;
            });
        }

        function renderScans() {
            const tbody = document.getElementById('scan-table-body');
            tbody.innerHTML = '';
            appData.scans.forEach(s => {
                const html = `
                    <tr>
                        <td>${s.id}</td>
                        <td>${s.target}</td>
                        <td>${s.date}</td>
                        <td>${s.findings}</td>
                        <td>${s.critical}</td>
                        <td><span class="badge badge-fixed">${s.status}</span></td>
                        <td>
                            <div class="action-icons">
                                <button class="action-btn">üëÅÔ∏è</button>
                                <button class="action-btn">‚¨áÔ∏è</button>
                            </div>
                        </td>
                    </tr>`;
                tbody.innerHTML += html;
            });
        }

        function renderUsers() {
            const tbody = document.getElementById('user-table-body');
            tbody.innerHTML = '';
            appData.users.forEach((u, index) => {
                const html = `
                    <tr>
                        <td>${u.name}</td>
                        <td>${u.email}</td>
                        <td><span class="badge ${u.badge === 'critical' ? 'badge-critical' : 'badge-high'}">${u.role}</span></td>
                        <td><span class="badge badge-fixed">${u.status}</span></td>
                        <td>${u.lastActive}</td>
                        <td>
                            <div class="action-icons">
                                <button class="action-btn">‚úèÔ∏è</button>
                                <button class="action-btn" onclick="deleteItem('users', ${index})">üö´</button>
                            </div>
                        </td>
                    </tr>`;
                tbody.innerHTML += html;
            });
        }

        function renderLogs() {
            const tbody = document.getElementById('log-table-body');
            tbody.innerHTML = '';
            appData.logs.forEach(l => {
                const html = `
                    <tr>
                        <td>${l.time}</td>
                        <td>${l.user}</td>
                        <td><span class="badge ${l.badge}">${l.action}</span></td>
                        <td>${l.resource}</td>
                        <td>${l.details}</td>
                    </tr>`;
                tbody.innerHTML += html;
            });
        }


        // --- 3. ACTIONS & EVENT HANDLERS ---

        function createVulnerability() {
            const title = document.getElementById('input-vuln-title').value;
            const severity = document.getElementById('input-vuln-severity').value;
            const target = document.getElementById('input-vuln-target').value;
            const cwe = document.getElementById('input-vuln-cwe').value || 'CWE-000';
            const assigned = document.getElementById('input-vuln-assigned').value;

            if(!title) { alert('Title is required'); return; }

            const newVuln = {
                id: '00' + (appData.vulnerabilities.length + 1),
                title: title,
                severity: severity,
                target: target,
                status: 'Open',
                cwe: cwe,
                assigned: assigned
            };

            appData.vulnerabilities.unshift(newVuln);
            addLog('Created', `Vuln #${newVuln.id}`, `Added ${title}`);
            
            renderAll();
            closeModal('newVulnerability');
            showNotification('‚úÖ Vulnerability created successfully!');
            
            // Reset form
            document.getElementById('input-vuln-title').value = '';
        }

        function createTarget() {
            const name = document.getElementById('input-target-name').value;
            const type = document.getElementById('input-target-type').value;
            const status = document.getElementById('input-target-status').value;

            if(!name) { alert('Target name is required'); return; }

            const newTarget = {
                id: 't' + Date.now(),
                name: name,
                type: type,
                status: status,
                api: type === 'API' ? 'Yes' : 'No',
                lastScan: 'Never'
            };

            appData.targets.unshift(newTarget);
            renderTargets();
            closeModal('newTarget');
            showNotification('‚úÖ Target added successfully!');
            document.getElementById('input-target-name').value = '';
        }

        function uploadEvidence() {
            const type = document.getElementById('input-ev-type').value;
            const desc = document.getElementById('input-ev-desc').value;
            const link = document.getElementById('input-ev-link').value;

            const newEv = {
                id: 'e' + Date.now(),
                type: type,
                desc: desc || 'No description',
                link: link,
                uploaded: 'Just now',
                badge: 'low'
            };

            appData.evidence.unshift(newEv);
            addLog('Upload', 'Evidence', `Uploaded ${type}`);
            renderEvidence();
            closeModal('uploadEvidence');
            showNotification('‚úÖ Evidence uploaded successfully!');
        }

        function addUser() {
            const name = document.getElementById('input-user-name').value;
            const email = document.getElementById('input-user-email').value;
            const role = document.getElementById('input-user-role').value;

            if(!name || !email) { alert('Name and email required'); return; }

            const newUser = {
                id: 'u' + Date.now(),
                name: name,
                email: email,
                role: role,
                status: 'Active',
                lastActive: 'Just now',
                badge: role === 'Admin' ? 'critical' : 'high'
            };

            appData.users.push(newUser);
            renderUsers();
            closeModal('addUser');
            showNotification('‚úÖ User added successfully!');
        }

        function runNewScan() {
            showNotification('‚ñ∂Ô∏è Scan started! This will take a moment...');
            addLog('Scan', 'System', 'Manual scan initiated');
            
            setTimeout(() => {
                const newScan = {
                    id: '#SC-00' + (appData.scans.length + 1),
                    target: 'example.com',
                    date: new Date().toLocaleString(),
                    findings: Math.floor(Math.random() * 20),
                    critical: Math.floor(Math.random() * 5),
                    status: 'Completed'
                };
                appData.scans.unshift(newScan);
                renderScans();
                showNotification('‚úÖ Scan completed successfully!');
            }, 2000);
        }

        function generateReport() {
            showNotification('‚úÖ Report generated! Downloading...');
            closeModal('generateReport');
        }

        function deleteItem(collection, index) {
            if(confirm('Are you sure you want to delete this item?')) {
                appData[collection].splice(index, 1);
                addLog('Deleted', collection, 'Item removed');
                renderAll();
                showNotification('üóëÔ∏è Item deleted.');
            }
        }

        function addLog(action, resource, details) {
            const log = {
                time: new Date().toLocaleString(),
                user: 'Current User',
                action: action,
                resource: resource,
                details: details,
                badge: 'low'
            };
            appData.logs.unshift(log);
            renderLogs();
        }

        function refreshDashboard() {
            renderAll();
            showNotification('üîÑ Dashboard refreshed!');
        }

        // UI Helpers
        function switchView(viewName) {
            const views = document.querySelectorAll('.view');
            views.forEach(view => view.style.display = 'none');
            const targetView = document.getElementById(`view-${viewName}`);
            if (targetView) targetView.style.display = 'block';
        }
        
        function switchTab(tabName, event) {
            const container = event.target.parentElement.parentElement; // Crude way to stay within view context
            const tabs = container.querySelectorAll('.tab');
            const contents = container.querySelectorAll('.tab-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            contents.forEach(c => c.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        function openModal(modalId) {
            document.getElementById(`modal-${modalId}`).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(`modal-${modalId}`).classList.remove('active');
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            document.getElementById('notificationText').textContent = message;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }
        
        function toggleSwitch(element) {
            element.classList.toggle('active');
        }

        // --- 4. STARTUP ---

        // Animation
        function initBackgroundAnimation() {
            const bgAnimation = document.getElementById('bgAnimation');
            for (let i = 0; i < 5; i++) {
                const line = document.createElement('div');
                line.className = 'circuit-line';
                line.style.top = `${Math.random() * 100}%`;
                line.style.height = '1px';
                line.style.width = '200px';
                line.style.animationDelay = `${i * 2}s`;
                bgAnimation.appendChild(line);
            }
        }

        // Listeners
        document.addEventListener('DOMContentLoaded', () => {
            initBackgroundAnimation();
            renderAll();

            // Navigation
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const view = item.getAttribute('data-view');
                    switchView(view);
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                });
            });

            // Modal Click Outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) modal.classList.remove('active');
                });
            });
        });
    </script>
</body>
</html>